<!DOCTYPE html>
<html>

<head>
  <title>jQuery injection into webview preload</title>
  <style>
    html,
    body {
      padding: 0;
      margin: 0;
    }
  </style>
</head>

<body style="overflow:hidden;">
  <webview id="webview" preload="./manipulateGoogle.js" src="http://google.com" style="position:absolute;width:100%;height:100%;"></webview>
  <script>
    var webview = document.getElementById("webview");
    onload = () => {
      // When everything is ready, trigger the events without problems
      webview.addEventListener("dom-ready", function () {
        // Show devTools if you want
        //webview.openDevTools();
        console.log("DOM-Ready, triggering events !");

        // Aler the scripts src of the website from the <webview>
        webview.send("request");

        // alert-something
        webview.send("alert-something", "Hey, i'm alerting this.");

        // change-text-element manipulating the DOM
        webview.send("change-text-element", {
          id: "myelementID",
          text: "My text"
        });
      });
    }

    // Process the data from the webview
    webview.addEventListener('ipc-message', function (event) {
      console.log(event);
      console.info(event.channel);
    });
  </script>
</body>

</html>